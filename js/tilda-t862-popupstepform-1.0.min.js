function t862_init(t){var e=document.getElementById("rec"+t),o;if(e&&e.querySelector(".t862")){var n=e.querySelector(".t-form");if(n){var r=e.querySelector(".t862__quiz-wrapper"),i=e.querySelectorAll(".t-input-group"),s=e.querySelector(".t862__btn_prev"),a=e.querySelector(".t862__btn_next"),c=e.querySelector(".t862__btn_result"),u=e.querySelector(".t-form__submit"),p=e.querySelector(".t-submit"),l=e.querySelector(".t-form__errorbox-middle");if(l)var d=l.querySelector(".t-form__errorbox-wrapper");var _='<div class="t862__capture-form t862__screen-wrapper t-step-form__step"></div>';l.insertAdjacentHTML("beforebegin",_),n.classList.remove("js-form-proccess");var f=e.querySelector(".t862__capture-form"),v=e.querySelector(".t862__result-title"),m=v?v.textContent:"",y=Boolean(r.getAttribute("data-auto-step-change")),S=!1,h,g=300;t862_workWithAnswerCode(e),Array.prototype.forEach.call(i,(function(t,e){t.setAttribute("data-step-number",e)})),t862_wrapCaptureForm(e);var b=Boolean(f.innerHTML||m),w=0,L=null,A=n.classList.contains("t-conditional-form"),q=!1,E;t862_createSteps(i);var C=t862_createStepsArray(e),k=C.length,x=e.querySelectorAll(".t862__screen-wrapper"),F;C[w]&&(A?t_onFuncLoad("t_form__conditionals__initStepForm",(function(){var o;L=t_form__conditionals__initStepForm({recId:t,steps:x,activeStepIndex:w,ignoredSteps:[".t862__capture-form"],ignoredInputGroups:[".t862__t-input-group_capture"],onConditionalFieldChange:function(t){k=t.totalActiveStepsCount-1,E=updateProgressValue(),t862_showCounter(e,E.counterCurrentStep,E.counterAllSteps),t862_setProgress(e,E.progressCurrentStep,E.progressAllSteps),checkIfShouldSubmitForm(),showOrHideButtons()}}),k=L.getState().totalActiveStepsCount-1,initForm()})):initForm())}}function initForm(){showStep(w),E=updateProgressValue(),t862_showCounter(e,E.counterCurrentStep,E.counterAllSteps),t862_disabledPrevBtn(e,w),e.setAttribute("data-animationappear","off"),e.style.opacity=1,y&&initAutoStepChange(),s.addEventListener("click",(function(t){handleGoPrevStep(t)})),a.addEventListener("click",(function(t){handleGoNextStep(t)})),Array.prototype.forEach.call(i,(function(t){t.addEventListener("keypress",(function(t){var e=n.querySelector(".t-step-form__step_active");"Enter"!==t.code&&13!==t.keyCode||n.classList.contains("js-form-proccess")||e.querySelector(".t-input-group_ta")||handleGoNextStep(t)}))})),c.addEventListener("click",(function(t){handleGoNextStep(t)})),t862_openToHook(e,x,f),e.addEventListener("click",(function(t){var o=t.target,n;!!o.closest('[type="submit"]')&&o&&t862_adjustStepToHeight(e)})),t862_adjustHeightOnResize(e)}function handleGoPrevStep(t){q||(t.preventDefault(),resetAutoStepChangeProgress(),checkFirstStep()||(w=L?L.getState().prevStepIndex:getActiveStepIndex()-1,L&&L.onStepChange(w),E=updateProgressValue(),t862_setProgress(e,E.progressCurrentStep,E.progressAllSteps),t862_showCounter(e,E.counterCurrentStep,E.counterAllSteps),t862_awayFromResultScreen(e),t862_hideError(e,w),t862_disabledPrevBtn(e,w),showStep(w),n.classList.contains("js-form-proccess")&&n.classList.remove("js-form-proccess")))}function handleGoNextStep(t){if(!q){t.preventDefault(),resetAutoStepChangeProgress();var o=t862_showError(e,r,w);if(o&&d&&(d.style.display="none"),!o){var n=checkLastStep();w=L?L.getState().nextStepIndex:getActiveStepIndex()+1,L&&L.onStepChange(w),E=updateProgressValue(),t862_setProgress(e,E.progressCurrentStep,E.progressAllSteps),t862_showCounter(e,E.counterCurrentStep,E.counterAllSteps),t862_disabledPrevBtn(e,w),n&&b?showCaptureForm():showStep(w)}}}function getActiveStepIndex(){return L?L.getState().activePossibleStepIndex:w}function updateProgressValue(){return{counterCurrentStep:getActiveStepIndex()+1,counterAllSteps:k,progressCurrentStep:getActiveStepIndex(),progressAllSteps:b?k:k-1}}function checkLastStep(){return getActiveStepIndex()===k-1}function checkFirstStep(){return 0===getActiveStepIndex()}function checkNextToLast(){return getActiveStepIndex()===k-2}function showOrHideButtons(){if(!b){if(checkNextToLast())return a.style.display="none",c.style.display="block",void(u.style.display="none");if(checkLastStep())return a.style.display="none",c.style.display="none",void(u.style.display="block")}if(checkLastStep())return a.style.display="none",c.style.display="block",void(u.style.display="none");a.style.display="block",c.style.display="none",u.style.display="none"}function showStep(t){var o=n.querySelector(".t-step-form__step_active"),r=C[t];if(o)animateStepSwitch(o,r,{onNewStepAnimationStart:function(){t862_checkMode(),checkIfShouldSubmitForm(),showOrHideButtons(),enableButtons(e);var t=e.querySelector(".t-range");t&&t_triggerEvent(t,"displayChanged"),q=!1,t862_adjustStepToHeight(e)},onAnimationStart:function(){q=!0,disableButtons(e)}});else{r&&r.classList.add("t-step-form__step_active"),t862_checkMode(),checkIfShouldSubmitForm(),showOrHideButtons();var i=e.querySelector(".t-range");i&&t_triggerEvent(i,"displayChanged"),t862_adjustStepToHeight(e)}}function showCaptureForm(){n.classList.add("js-form-proccess");var t=e.querySelector(".t862__quiz-description"),o;animateStepSwitch(n.querySelector(".t-step-form__step_active"),f,{onAnimationStart:function(){q=!0,t&&(t.style.display="none"),v&&(v.style.display="block"),c.style.display="none",u.style.display="block",disableButtons(e)},onNewStepAnimationStart:function(){t862_checkMode(),enableButtons(e),q=!1,t862_adjustStepToHeight(e)}})}function animateStepSwitch(t,e,o){function handleFadeInEnd(){e.classList.remove("t-step-form__step_fadeIn"),e.removeEventListener("animationend",handleFadeInEnd),e.removeEventListener("animationcancel",handleFadeInCancel),o.onAnimationComplete&&o.onAnimationComplete()}function handleFadeInCancel(){e.classList.remove("t-step-form__step_fadeIn"),e.removeEventListener("animationend",handleFadeInEnd),e.removeEventListener("animationcancel",handleFadeInCancel)}function animateStepIn(){e.addEventListener("animationend",handleFadeInEnd),e.addEventListener("animationcancel",handleFadeInCancel),e.classList.add("t-step-form__step_active"),e.classList.add("t-step-form__step_fadeIn"),o.onNewStepAnimationStart&&o.onNewStepAnimationStart()}function handleFadeOutEnd(){t.classList.remove("t-step-form__step_fadeOut"),t.classList.remove("t-step-form__step_active"),t.removeEventListener("animationend",handleFadeOutEnd),e&&animateStepIn()}function animateStepOut(){t.addEventListener("animationend",handleFadeOutEnd),t.classList.add("t-step-form__step_fadeOut")}return o.onAnimationStart&&o.onAnimationStart(),t?animateStepOut():animateStepIn()}function disableButtons(){s&&(s.disabled=!0),a&&(a.disabled=!0),c&&(c.disabled=!0),p&&(p.disabled=!0)}function enableButtons(){checkFirstStep()||s&&(s.disabled=!1),a&&(a.disabled=!1),c&&(c.disabled=!1),p&&(p.disabled=!1)}function initAutoStepChange(){var t=["ri","rd","rs","sb","cb"],e;C.filter((function(e){var o=e.querySelector(".t-input-group");return-1!==t.indexOf(o.getAttribute("data-field-type"))})).forEach((function(t){var e=Array.prototype.slice.call(t.querySelectorAll(".js-tilda-rule"));(e=e.filter((function(t){return!t.classList.contains("t-radio-ownanswer")}))).forEach((function(t){t.addEventListener("change",handleAutoStepChange)}))}))}function handleAutoStepChange(t){checkLastStep()&&!b||S||(S=!0,h=setTimeout((function(){handleGoNextStep(t),resetAutoStepChangeProgress()}),g))}function resetAutoStepChangeProgress(){clearTimeout(h),S=!1}function checkIfShouldSubmitForm(){!b&&checkLastStep()?n.classList.add("js-form-proccess"):n.classList.remove("js-form-proccess")}}function t862_workWithAnswerCode(t){for(var e=t.querySelectorAll(".t-input-group_ri input"),o=t.querySelectorAll(".t-input-group_rd input"),n=t.querySelectorAll(".t-input-group_sb option"),r=0;r<e.length;r++){var i;if(-1!==(i=e[r]).value.indexOf("value::")){t862_setAnswerCode(i);var s=i.parentNode.querySelector(".t-img-select__text");s&&(s.textContent=s.textContent.split("value::")[0].trim())}}for(var r=0;r<o.length;r++){var i;if(-1!==(i=o[r]).value.indexOf("value::")){t862_setAnswerCode(i);var a=i.parentNode;a&&(a.innerHTML=a.innerHTML.split("value::")[0].trim())}}for(var r=0;r<n.length;r++){var c=n[r];-1!==c.value.indexOf("value::")&&(t862_setAnswerCode(c),c.textContent=c.textContent.split("value::")[0].trim())}}function t862_createSteps(t){Array.prototype.forEach.call(t,(function(t){if(!t.classList.contains("t862__t-input-group_capture")){var e=document.createElement("div");e.classList.add("t862__screen-wrapper"),e.classList.add("t-step-form__step"),t.parentNode.insertBefore(e,t),e.appendChild(t)}}))}function t862_setAnswerCode(t){t.value=t.value.split("value::")[1].trim()}function t862_wrapCaptureForm(t){var e=t.querySelector(".t862__capture-form"),o=t.querySelectorAll(".t-input-group"),n=t.querySelector(".t862__quiz-form-wrapper");Array.prototype.forEach.call(o,(function(t){var r=t,i=r.classList.contains("t-input-group_em"),s=r.classList.contains("t-input-group_nm"),a=r.classList.contains("t-input-group_ph"),c=r.classList.contains("t-input-group_cb"),u,p=4;if(r.getAttribute("data-step-number")>=o.length-4){var l=!0;if(n.classList.contains("t862__quiz-form-wrapper_newcapturecondition")){var d=t862_getNextAll(r);Array.prototype.forEach.call(d,(function(t){l=t.classList.contains("t-input-group_cb")||t.classList.contains("t-input-group_em")||t.classList.contains("t-input-group_nm")||t.classList.contains("t-input-group_ph")}))}l&&(i||s||a||c)&&(r.classList.add("t862__t-input-group_capture"),e.appendChild(r))}}))}function t862_showCounter(t,e,o){var n=t.querySelector(".t862__quiz-description-counter");n&&(n.innerHTML=e+"/"+o)}function t862_setProgress(t,e,o){var n=t.querySelector(".t862__progressbar"),r=parseFloat(getComputedStyle(n).width),i=t.querySelector(".t862__progress"),s=r/o,a=100*Math.abs(e*s/r)+"%";i&&(i.style.width=a)}function t862_createStepsArray(t){var e=t.querySelectorAll(".t862__screen-wrapper"),o=[];return Array.prototype.forEach.call(e,(function(t){t.classList.contains("t862__capture-form")||o.push(t)})),o}function t862_disabledPrevBtn(t,e){var o=t.querySelector(".t862__btn_prev");0===e?o.setAttribute("disabled",""):o.removeAttribute("disabled")}function t862_openToHook(t,e,o){var n=t.querySelector(".t-popup"),r=t.querySelector(".t-popup__close"),i=t.querySelectorAll('a[href*="#"]'),s=n.getAttribute("data-tooltip-hook"),a=n.getAttribute("data-track-popup"),c=n.querySelector(".t-form__submit .t-submit"),u=t862__escClosePopup.bind(n,t);s&&(t_onFuncLoad("t_popup__addAttributesForAccessibility",(function(){t_popup__addAttributesForAccessibility(s)})),document.addEventListener("click",(function(n){var r=n.target.closest('a[href="'+s+'"]');if(r&&(n.preventDefault(),window.isMobile||r.classList.add("t-popup__triggered-btn"),t862_showPopup(t,e,o,u),setTimeout((function(){t862_adjustStepToHeight(t,{initial:!0})}),50),t862__lazyLoad(),a)){var i=s;"#popup:"==i.substring(0,7)&&(i=i.substring(7)),Tilda.sendEventToStatistics(a,i)}}))),n.addEventListener("click",(function(e){e.target===this&&t862_closePopup(t,u)})),r.addEventListener("click",(function(){t862_closePopup(t,u)}));for(var p=0;p<i.length;p++)i[p].addEventListener("click",(function(){var e=this.getAttribute("href");(!e||"#price:"!=e.substring(0,7)&&"#order:"!=e.substring(0,7))&&(t862_closePopup(t,u),e&&"#popup:"!=e.substring(0,7)||setTimeout((function(){t_triggerEvent(document.body,"popupShowed"),document.body.classList.add("t-body_popupshowed")}),300))})),i[p].addEventListener("keydown",(function(t){13===t.keyCode&&(window.isMobile||this.classList.add("t-popup__triggered-btn"))}));var l=c&&c.getAttribute("href");l&&"#order:"===l.substring(0,7)&&c.addEventListener("click",(function(){t862_closePopup(t,u)}))}function t862_checkMode(){document.getElementById("allrecords").getAttribute("data-tilda-mode")||t862__lazyLoad()}function t862__lazyLoad(){"y"!==window.lazy&&"yes"!==document.getElementById("allrecords").getAttribute("data-tilda-lazy")||t_onFuncLoad("t_lazyload_update",(function(){t_lazyload_update()}))}function t862_hideError(t,e){var o,n=t862_createStepsArray(t)[e];n&&(n.classList.remove("js-error-control-box"),n.querySelector(".t-input-error").innerHTML="")}function t862_awayFromResultScreen(t){var e=t.querySelector(".t862__quiz-description"),o=t.querySelector(".t862__result-title");o&&(o.style.display="none"),e&&(e.style.display="block")}function t862_showError(t,e,o){if(e.classList.contains("t862__quiz-published"))return t862_setError(t,o)}function t862_setError(t,e){var o,n=t862_createStepsArray(t)[e],r;if("object"!=typeof window.tildaForm)return r;var i=window.tildaForm.validate(n),s=i[0];if(s){var a=s.type[0],c=t.querySelector(".t-form .t-form__errorbox-middle .js-rule-error-"+a),u="";c&&(u=c.textContent),u||t_onFuncLoad("t_forms__getMsg",(function(){u=t_forms__getMsg(a)})),"emptyfill"===a?r=!1:(n&&n.classList.add("js-error-control-box"),r=window.tildaForm.showErrors(n,i));var p=n.querySelector(".t-input-error");p&&(p.innerHTML=u)}return r}function t862_onSuccess(t){t_forms__onSuccess(t)}function t862_lockScroll(){var t=document.body;if(!t.classList.contains("t-body_scroll-locked")){var e=void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||t.parentNode||t).scrollTop;t.classList.add("t-body_scroll-locked"),t.style.top="-"+e+"px",t.setAttribute("data-popup-scrolltop",e)}}function t862_unlockScroll(){var t=document.body;if(t.classList.contains("t-body_scroll-locked")){var e=t.getAttribute("data-popup-scrolltop");t.classList.remove("t-body_scroll-locked"),t.style.top="",t.removeAttribute("data-popup-scrolltop"),window.scrollTo(0,parseInt(e))}}function t862_showPopup(t,e,o,n){var r=window.innerWidth,i=document.body,s=t.querySelector(".t-popup"),a=s.querySelector(".t-popup__container"),c=t.querySelector(".t862__quiz"),u=t.querySelector(".t-range");s.style.display="block",u&&t_triggerEvent(u,"popupOpened"),t862__lazyLoad(),setTimeout((function(){s.classList.add("t-popup_show"),a.classList.add("t-popup__container-animated"),t_onFuncLoad("t_popup__trapFocus",(function(){t_popup__trapFocus(s)})),r>640&&c.classList.contains("t862__quiz_fixedheight")&&t862_setHeight(t,e,o),r>640&&c.classList.contains("t862__quiz_nofixedheight")&&(a.style.transition="height ease-in-out 0.3s"),r<=640&&t862_setMobileHeight(),t862__showJivo("1","1")}),50),t_triggerEvent(document.body,"popupShowed"),i.classList.add("t-body_popupshowed"),i.classList.add("t862__body_popupshowed"),/iPhone|iPad|iPod/i.test(navigator.userAgent)&&!window.MSStream&&setTimeout((function(){t862_lockScroll()}),500),document.addEventListener("keydown",n)}function t862__escClosePopup(t,e){"Escape"===arguments[1].key&&t862_closePopup(t,e)}var t862_debounceAdjustheight=t862_debounce(t862_adjustStepToHeight,200);function t862_adjustHeightOnResize(t){window.addEventListener("resize",(function(){t862_debounceAdjustheight(t)}))}function t862_debounce(t,e){var o;return function(){var n=Array.prototype.slice.call(arguments);clearTimeout(o),o=setTimeout((function(){t.apply(null,n)}),e)}}function t862_adjustStepToHeight(t,e){var o=30;e=e||{initial:!1};var n=t.querySelector(".t862__quiz_nofixedheight");if(n){var r=t.querySelector(".t862__quiz-description-wrapper"),i=t.querySelector(".t862__quiz-form-wrapper"),s=r?r.offsetHeight:0,a=i?i.offsetHeight:0;if(0!==a){var c=t.querySelector(".t862__wrapper"),u=getComputedStyle(c),p,l=s+a,d=l+(parseInt(u.paddingBottom,10)||0),_=parseInt(getComputedStyle(n).height,10),f=Math.abs(_-l);if(e.initial)return t862_resizePopup(t,d),void(n.style.height=l+"px");f<o||(l>_&&(n.style.overflow="hidden",setTimeout((function(){n.style.overflow=""}),300)),t862_resizePopup(t,d),n.style.height=l+"px")}}else t862_resizePopup(t)}function t862_setHeight(t,e){var o=t.querySelector(".t862__quiz-form-wrapper"),n=t.querySelector(".t862__result-title"),r=t.querySelector(".t862__quiz-description"),i=n?n.offsetHeight:0,s=r?r.offsetHeight:0,a=Array.prototype.slice.call(e),c=null;a.forEach((function(t){var e=t.classList.contains("t-step-form__step_active");e||t.classList.add("t-step-form__step_active"),c=Math.max(t.offsetHeight,c),e||t.classList.remove("t-step-form__step_active")})),a.forEach((function(t){t.style.minHeight=c+"px"})),o.style.minHeight=c+"px";var u=Math.max(s,i),p=o.offsetHeight,l=t.querySelector(".t862__btn-wrapper").offsetHeight;t.querySelector(".t862__wrapper").style.minHeight=u+p+l+"px"}function t862_setMobileHeight(){t862_calcVH(),window.addEventListener("resize",t862_calcVH)}function t862_calcVH(){var t=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",t+"px")}function t862_closePopup(t,e){var o=document.body,n=t.querySelector(".t-popup"),r=n.querySelector(".t-popup__container"),i;n===document.querySelector(".t-popup.t-popup_show")&&(t_triggerEvent(document.body,"popupHidden"),o.classList.remove("t-body_popupshowed"),o.classList.remove("t862__body_popupshowed")),/iPhone|iPad|iPod/i.test(navigator.userAgent)&&!window.MSStream&&t862_unlockScroll(),t_onFuncLoad("t_popup__addFocusOnTriggerButton",(function(){t_popup__addFocusOnTriggerButton()})),n.classList.remove("t-popup_show"),r.style.removeProperty("transition"),t862__showJivo("2147483647","2147483648"),setTimeout((function(){for(var t=document.querySelectorAll(".t-popup:not(.t-popup_show)"),e=0;e<t.length;e++)t[e].style.display="none"}),300),document.removeEventListener("keydown",e)}function t862_resizePopup(t,e){var o=window.innerHeight-120,n=t.querySelector(".t-popup__container"),r=getComputedStyle(n,null),i=parseInt(r.paddingTop)||0,s=parseInt(r.paddingBottom)||0,a=n.clientHeight-(i+s),c;(e||a)>o?n.classList.add("t-popup__container-static"):n.classList.remove("t-popup__container-static")}function t862__showJivo(t,e){for(var o=document.querySelectorAll("._show_1e.wrap_mW.__jivoMobileButton"),n=document.querySelectorAll(".label_39#jvlabelWrap"),r=0;r<o.length;r++)o[r].style.zIndex=t;for(var r=0;r<n.length;r++)n[r].style.zIndex=e}function t862_getNextAll(t){for(var e=[],o=t;o.nextElementSibling;)o.nextElementSibling.classList.contains("t-input-group")&&e.push(o.nextElementSibling),o=o.nextElementSibling;return e}function t_triggerEvent(t,e){var o;document.createEvent?(o=document.createEvent("HTMLEvents")).initEvent(e,!0,!1):document.createEventObject&&((o=document.createEventObject()).eventType=e),o.eventName=e,t.dispatchEvent?t.dispatchEvent(o):t.fireEvent?t.fireEvent("on"+o.eventType,o):t[e]?t[e]():t["on"+e]&&t["on"+e]()}
